// ==UserScript==
// @name         tool-table-fmt-web
// @namespace    http://tampermonkey.net/
// @version      2024-08-02
// @description  powerful tool for web table process
// @author       jiyahuja
// @match        http://*/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=amazon.dev
// @grant        GM_xmlhttpRequest
// @connect      hooks.slack.com
// @connect      quip-amazon.com
// @connect      hooks.slack.com
// @run-at       document-idle
// ==/UserScript==

'use strict';
const _0x483b86=_0x4195;function _0x37ee(){const _0x1b4636=['href','responseTe','Kit/537.36','14439VKlWCl','GET','ieving\x20Qui','st\x20failed:','TfHYU','download','ZMWoK','0\x20(Windows','Pojkp','nsData','manufactur',')\x20AppleWeb','trim','item_packa','FmHlq','push','548oFtioT','\x20ID\x20','torAll','i.crisp.co','scription','forEach','required','ctURL','XAdae','ebYkd','asin:asc','HDUgq','log','ACFrf','from','filter','n/json','th,\x20td','6182CmLxCd','BzTYy','createObje','ldPis','batteries_','Win64;\x20x64','47240ydMzyL','stringify','LZTmV','5.0.0.0\x20Sa','6bqGoZx','phqzN','parse','VmKoG','E\x20B07KFVKP','click','sgaqG','catch','wGERC','product_de','Error:','ItaGl','5192450JqXcmX','XKPfg','global_cat','tahYr','8qOGzJv','omkUh','MtdMZ','lPyzO','aHHgT','map','Bearer\x20','XjAst','gKMTc','fBOlz','bCsde','IUACM','brand','ttYzt','\x20Chrome/11','Table\x20with','PTZWF','rDLPj','gl_product','ById','Mozilla/5.','fQYMn','item_dimen','table','7C\x20B089YVM','ful:','Shfgh','1281292HcZZje','dev/getAsi','jetTable','rs.amazon.','fari/537.3','znQPP','ike\x20Gecko)','Win32','YQM\x20B015IX','https://ap','shift','createElem','\x20NT\x2010.0;\x20','vsaeV','POST\x20reque','SzWlx','applicatio','RhbWI','jmbCw','Txqby','st\x20success','rEenC','ent','textConten','gUHLn','\x20(KHTML,\x20l','tpFp','KrVUv','92Q6','JNmCr','fjtXp','mpxyp','aofhu','error','POST','_group_typ','ngbil','B01LFEI6L4','ge_dimensi','then','sions','oyaMq','URL','kxqmz','JnlUp','alog_owner','vvajK','bullet_poi','join','\x20B011XO6PG','item_name','getElement','included','OPTIONS','vZjyB','\x20not\x20found','ons','QiAJk','2427256TYZEWI','KfTGH','p\x20content:','split','pop','length','3520258qxSyIJ','NXdRf','Error\x20retr','appendChil','hqSMp','9379197NBxlOx','YLFKH','text/csv','nAFAq','querySelec','GWwDH','OLUxI'];_0x37ee=function(){return _0x1b4636;};return _0x37ee();}(function(_0x44361c,_0x19e993){const _0x58d2d5=_0x4195,_0x182557=_0x44361c();while(!![]){try{const _0x4222ad=parseInt(_0x58d2d5(0x1cd))/(0x1a5*-0x3+0x18cf+0x13df*-0x1)+-parseInt(_0x58d2d5(0x161))/(0x2055*0x1+0x1918+-0x396b)+parseInt(_0x58d2d5(0x176))/(-0x156f+0xd*-0x216+0x3090)*(parseInt(_0x58d2d5(0x186))/(0x20cc+0x243b+-0x4503))+-parseInt(_0x58d2d5(0x1ae))/(-0x1*0x1529+0x1*-0x227+0x1755)*(-parseInt(_0x58d2d5(0x1a2))/(0x1d9f+0xf9*0xa+-0x2753))+parseInt(_0x58d2d5(0x167))/(-0x975*0x3+-0x16f9+0x335f)+parseInt(_0x58d2d5(0x1b2))/(0x1*-0xfa7+0x16c6+-0x717)*(parseInt(_0x58d2d5(0x16c))/(0x210f+0x2*-0x412+0x27d*-0xa))+parseInt(_0x58d2d5(0x19e))/(0x23e4+0x1fd4+-0x21d7*0x2)*(-parseInt(_0x58d2d5(0x198))/(0x15cb+-0xe1*0x1d+0x3bd));if(_0x4222ad===_0x19e993)break;else _0x182557['push'](_0x182557['shift']());}catch(_0x5f489f){_0x182557['push'](_0x182557['shift']());}}}(_0x37ee,0x9ead6+-0x1*0xca478+0xcbadc));function _0x4195(_0x4df3f3,_0x48c539){const _0x3c424f=_0x37ee();return _0x4195=function(_0x363e1e,_0x467329){_0x363e1e=_0x363e1e-(0x2e*-0x6d+-0x1d7d+0x323e);let _0x3c0796=_0x3c424f[_0x363e1e];return _0x3c0796;},_0x4195(_0x4df3f3,_0x48c539);}const updataQuipSlack=(_0x341393,_0x28a067)=>{const _0x480869=_0x4195,_0x1a5a23={'MtdMZ':_0x480869(0x135)+_0x480869(0x13b)+_0x480869(0x1cb),'GWwDH':_0x480869(0x135)+_0x480869(0x179),'gKMTc':function(_0x3ed51b,_0x1059fe){return _0x3ed51b(_0x1059fe);},'TfHYU':_0x480869(0x149),'wGERC':_0x480869(0x137)+_0x480869(0x196)};_0x1a5a23[_0x480869(0x1ba)](GM_xmlhttpRequest,{'method':_0x1a5a23[_0x480869(0x17a)],'url':_0x28a067,'data':JSON[_0x480869(0x19f)](_0x341393),'headers':{'Content-Type':_0x1a5a23[_0x480869(0x1aa)]},'onload':function(_0x31dbe1){const _0xe32de9=_0x480869;console[_0xe32de9(0x192)](_0x1a5a23[_0xe32de9(0x1b4)],_0x31dbe1);},'onerror':function(_0x606eb4){const _0xb7134b=_0x480869;console[_0xb7134b(0x148)](_0x1a5a23[_0xb7134b(0x171)],_0x606eb4);}});},convertToCSV=_0x5d14b1=>{const _0x3dfb1f=_0x4195,_0x34c7a2=_0x5d14b1[_0x3dfb1f(0x164)]('\x0a'),_0x3303b2=[];for(const _0x472383 of _0x34c7a2){const _0x209a06=_0x472383[_0x3dfb1f(0x164)](','),_0x91026a=_0x209a06[_0x3dfb1f(0x1b7)](_0x5703ff=>'\x22'+_0x5703ff+'\x22');_0x3303b2[_0x3dfb1f(0x185)](_0x91026a[_0x3dfb1f(0x157)](','));}return _0x3303b2[_0x3dfb1f(0x157)]('\x0a');},downloadCSV=(_0x4c0870,_0xc1c652)=>{const _0x8e34e3=_0x4195,_0x4c0237={'JnlUp':_0x8e34e3(0x16e)},_0x479e1b=new Blob([_0x4c0870],{'type':_0x4c0237[_0x8e34e3(0x153)]}),_0x269bf1=document[_0x8e34e3(0x132)+_0x8e34e3(0x13d)]('a');_0x269bf1[_0x8e34e3(0x173)]=window[_0x8e34e3(0x151)][_0x8e34e3(0x19a)+_0x8e34e3(0x18d)](_0x479e1b),_0x269bf1[_0x8e34e3(0x17b)]=_0xc1c652,_0x269bf1[_0x8e34e3(0x1a7)]();},html2table=_0x4aab61=>{const _0x42bc6c=_0x4195,_0x674f03={'fQYMn':_0x42bc6c(0x197)},_0x202b23=document[_0x42bc6c(0x15a)+_0x42bc6c(0x1c5)](_0x4aab61);if(!_0x202b23){console[_0x42bc6c(0x148)](_0x42bc6c(0x1c1)+_0x42bc6c(0x187)+_0x4aab61+(_0x42bc6c(0x15e)+'.'));return;}const _0x327879=_0x202b23[_0x42bc6c(0x170)+_0x42bc6c(0x188)]('tr'),_0x126da1=[];return _0x327879[_0x42bc6c(0x18b)](_0x1ec908=>{const _0x1ec405=_0x42bc6c,_0xb249bf=_0x1ec908[_0x1ec405(0x170)+_0x1ec405(0x188)](_0x674f03[_0x1ec405(0x1c7)]),_0x1d1799=Array[_0x1ec405(0x194)](_0xb249bf)[_0x1ec405(0x1b7)](_0x5ae9bb=>_0x5ae9bb[_0x1ec405(0x13e)+'t'][_0x1ec405(0x182)]()),_0x2955ab=_0x1d1799[_0x1ec405(0x1b7)](_0x27e310=>'\x22'+_0x27e310+'\x22');_0x126da1[_0x1ec405(0x185)](_0x2955ab[_0x1ec405(0x157)](','));}),_0x126da1[_0x42bc6c(0x157)]('\x0a');};function csvToHtmlTable(_0x1f1226){const _0x7412ed=_0x4195,_0x3742fc={'BzTYy':_0x7412ed(0x1c9),'nAFAq':_0x7412ed(0x1cf),'fjtXp':function(_0x30b5aa,_0x2fd26b){return _0x30b5aa<_0x2fd26b;}},_0x38e75d=_0x1f1226[_0x7412ed(0x164)]('\x0a'),_0x4102af=document[_0x7412ed(0x132)+_0x7412ed(0x13d)](_0x3742fc[_0x7412ed(0x199)]);_0x4102af['id']=_0x3742fc[_0x7412ed(0x16f)];const _0x23a498=_0x38e75d[0xe9f+0x65b*-0x1+-0x844][_0x7412ed(0x164)](',')[_0x7412ed(0x195)](Boolean),_0x131c73=document[_0x7412ed(0x132)+_0x7412ed(0x13d)]('tr');for(const _0xa86286 of _0x23a498){const _0x1597f1=document[_0x7412ed(0x132)+_0x7412ed(0x13d)]('th');_0x1597f1[_0x7412ed(0x13e)+'t']=_0xa86286,_0x131c73[_0x7412ed(0x16a)+'d'](_0x1597f1);}_0x4102af[_0x7412ed(0x16a)+'d'](_0x131c73);for(let _0x1a9d4c=0x222b+-0x19e*0x13+-0x370;_0x3742fc[_0x7412ed(0x145)](_0x1a9d4c,_0x38e75d[_0x7412ed(0x166)]);_0x1a9d4c++){const _0x562515=_0x38e75d[_0x1a9d4c][_0x7412ed(0x164)](','),_0x20b161=document[_0x7412ed(0x132)+_0x7412ed(0x13d)]('tr');for(let _0x453933=-0x7a*-0x4e+-0x2406+-0x2*0x93;_0x3742fc[_0x7412ed(0x145)](_0x453933,_0x23a498[_0x7412ed(0x166)]);_0x453933++){const _0x44cdbd=document[_0x7412ed(0x132)+_0x7412ed(0x13d)]('td');_0x44cdbd[_0x7412ed(0x13e)+'t']=_0x562515[_0x453933],_0x20b161[_0x7412ed(0x16a)+'d'](_0x44cdbd);}_0x4102af[_0x7412ed(0x16a)+'d'](_0x20b161);}return _0x4102af;}function parseCSV(_0x50833c){const _0x3776d3=_0x4195,_0x1f2595={'YLFKH':function(_0x151093,_0x5cc75d){return _0x151093<_0x5cc75d;}},_0x1a6718=_0x50833c[_0x3776d3(0x164)]('\x0a'),_0x383b14=_0x1a6718[-0x153b+-0x24f4+0x3a2f][_0x3776d3(0x164)](',')[_0x3776d3(0x195)](Boolean),_0x3090d8=[];for(let _0x3fe5aa=-0x1c4e+-0x1c25*-0x1+0x2a;_0x1f2595[_0x3776d3(0x16d)](_0x3fe5aa,_0x1a6718[_0x3776d3(0x166)]);_0x3fe5aa++){const _0x4b4bc2=_0x1a6718[_0x3fe5aa][_0x3776d3(0x164)](','),_0x4176f3={};for(let _0x3f4881=-0x3b*0x26+-0x1003*0x2+0x28c8;_0x1f2595[_0x3776d3(0x16d)](_0x3f4881,_0x383b14[_0x3776d3(0x166)]);_0x3f4881++){_0x4176f3[_0x383b14[_0x3f4881]]=_0x4b4bc2[_0x3f4881];}_0x3090d8[_0x3776d3(0x185)](_0x4176f3);}return[_0x383b14,_0x3090d8];}function getQuipContent(_0xf70e53,_0x5dfbd7){const _0x28d295=_0x4195,_0x44abdb={'aHHgT':function(_0x12fc84,_0x5bc6f0){return _0x12fc84(_0x5bc6f0);},'ZMWoK':_0x28d295(0x169)+_0x28d295(0x178)+_0x28d295(0x163),'KfTGH':function(_0x31793f,_0x3735e6){return _0x31793f(_0x3735e6);},'kxqmz':function(_0x4e254f,_0x181026){return _0x4e254f(_0x181026);},'rEenC':_0x28d295(0x177)};return new Promise((_0x10aaf4,_0x3338d5)=>{const _0x5a89c5=_0x28d295;_0x44abdb[_0x5a89c5(0x152)](GM_xmlhttpRequest,{'method':_0x44abdb[_0x5a89c5(0x13c)],'url':_0xf70e53,'headers':{'Authorization':_0x5a89c5(0x1b8)+_0x5dfbd7},'onload':function(_0x5aac58){const _0x9b96c8=_0x5a89c5,_0x1d3f76=_0x5aac58[_0x9b96c8(0x174)+'xt'];_0x44abdb[_0x9b96c8(0x1b6)](_0x10aaf4,_0x1d3f76);},'onerror':function(_0x267017){const _0x436442=_0x5a89c5;console[_0x436442(0x148)](_0x44abdb[_0x436442(0x17c)],_0x267017),_0x44abdb[_0x436442(0x162)](_0x3338d5,_0x267017);}});});}function tpFpProcess(_0x151ac1,_0xdfcdfa,_0x1e4f14,_0x5d10a6=!![],_0x37fb95=_0x483b86(0x141)){const _0x256584=_0x483b86,_0x30c7cf={'mpxyp':function(_0x2d6736,_0x1bc133){return _0x2d6736(_0x1bc133);},'vvajK':_0x256584(0x14c)+_0x256584(0x158)+_0x256584(0x1a6)+_0x256584(0x1ca)+_0x256584(0x12f)+_0x256584(0x143),'ttYzt':_0x256584(0x15c),'OLUxI':_0x256584(0x130)+_0x256584(0x189)+_0x256584(0x1d0)+_0x256584(0x1ce)+_0x256584(0x17f),'rDLPj':_0x256584(0x190),'vZjyB':_0x256584(0x159),'RhbWI':_0x256584(0x1ab)+_0x256584(0x18a),'FmHlq':_0x256584(0x156)+'nt','ngbil':_0x256584(0x183)+_0x256584(0x14d)+_0x256584(0x15f),'ACFrf':_0x256584(0x1c8)+_0x256584(0x14f),'jmbCw':_0x256584(0x19c)+_0x256584(0x15b),'fBOlz':_0x256584(0x19c)+_0x256584(0x18c),'vsaeV':_0x256584(0x1b0)+_0x256584(0x154),'PTZWF':_0x256584(0x1be),'JNmCr':_0x256584(0x1c4)+_0x256584(0x14a)+'e','LZTmV':_0x256584(0x180)+'er','Txqby':_0x256584(0x12e),'XKPfg':_0x256584(0x1c6)+_0x256584(0x17d)+_0x256584(0x133)+_0x256584(0x19d)+_0x256584(0x181)+_0x256584(0x175)+_0x256584(0x140)+_0x256584(0x12d)+_0x256584(0x1c0)+_0x256584(0x1a1)+_0x256584(0x12b)+'6','XAdae':_0x256584(0x149),'XjAst':_0x256584(0x137)+_0x256584(0x196),'hqSMp':_0x256584(0x1ac),'oyaMq':function(_0x210543,_0x532b6c,_0x2e23ad){return _0x210543(_0x532b6c,_0x2e23ad);}};return new Promise((_0x379081,_0x2c2342)=>{const _0x17b6cb=_0x256584,_0x348433={'omkUh':_0x30c7cf[_0x17b6cb(0x1c3)],'tahYr':_0x30c7cf[_0x17b6cb(0x15d)],'HDUgq':_0x30c7cf[_0x17b6cb(0x138)],'ebYkd':_0x30c7cf[_0x17b6cb(0x184)],'NXdRf':_0x30c7cf[_0x17b6cb(0x14b)],'VmKoG':_0x30c7cf[_0x17b6cb(0x193)],'Pojkp':_0x30c7cf[_0x17b6cb(0x139)],'IUACM':_0x30c7cf[_0x17b6cb(0x1bb)],'bCsde':_0x30c7cf[_0x17b6cb(0x134)],'sgaqG':_0x30c7cf[_0x17b6cb(0x1c2)],'ItaGl':_0x30c7cf[_0x17b6cb(0x144)],'KrVUv':_0x30c7cf[_0x17b6cb(0x1a0)],'znQPP':_0x30c7cf[_0x17b6cb(0x13a)],'gUHLn':_0x30c7cf[_0x17b6cb(0x1af)],'QiAJk':function(_0x10da1d,_0x91acd){const _0x351f66=_0x17b6cb;return _0x30c7cf[_0x351f66(0x146)](_0x10da1d,_0x91acd);},'SzWlx':_0x30c7cf[_0x17b6cb(0x18e)],'phqzN':_0x30c7cf[_0x17b6cb(0x172)],'aofhu':_0x30c7cf[_0x17b6cb(0x1b9)],'Shfgh':_0x30c7cf[_0x17b6cb(0x16b)],'lPyzO':function(_0x2e710a,_0x333e40){const _0x3480cd=_0x17b6cb;return _0x30c7cf[_0x3480cd(0x146)](_0x2e710a,_0x333e40);}};_0x30c7cf[_0x17b6cb(0x150)](getQuipContent,_0x151ac1,_0xdfcdfa)[_0x17b6cb(0x14e)](_0x2098f3=>{const _0x5ae89e=_0x17b6cb,_0x36a1ef={'ldPis':function(_0x4e1fa5,_0x440bcc){const _0x187aa5=_0x4195;return _0x30c7cf[_0x187aa5(0x146)](_0x4e1fa5,_0x440bcc);}};var _0x1bc53a='';let _0x3723d0=_0x2098f3[_0x5ae89e(0x164)]('\x0a'),_0x1fc718=_0x3723d0[_0x5ae89e(0x195)](_0x5ecc3d=>_0x5ecc3d[_0x5ae89e(0x182)]()!=='');_0x1fc718[_0x5ae89e(0x131)]();let _0x3ce37e;const _0x4233c4=_0x1fc718[_0x5ae89e(0x1b7)](_0xef57da=>{const _0x1758c8=_0x5ae89e;if(_0xef57da){let _0x7c9523=_0xef57da[_0x1758c8(0x164)](',')[_0x1758c8(0x165)](),_0xe857a=_0x7c9523[_0x1758c8(0x164)]('\x20'),_0x3799f0=_0xef57da[_0x1758c8(0x164)](',');_0x3799f0[_0x1758c8(0x165)]();let _0xa390db=_0x3799f0[_0x1758c8(0x157)](',');const _0x1a1da9=_0xe857a[_0x1758c8(0x195)](_0x604ff1=>_0x604ff1!==''&&_0x604ff1!==undefined);return _0x1bc53a+=_0x1a1da9[_0x1758c8(0x157)]('\x20'),_0x1bc53a+='\x20',{'Description':_0xa390db,'ASIN':_0x1a1da9};}});let _0x3240f3=_0x30c7cf[_0x5ae89e(0x155)];_0x30c7cf[_0x5ae89e(0x146)](GM_xmlhttpRequest,{'method':_0x30c7cf[_0x5ae89e(0x1bf)],'url':_0x30c7cf[_0x5ae89e(0x172)],'onload':function(_0x485051){const _0x5e8438=_0x5ae89e,_0x3f4e81={'catalogSearchAdapterQueryParams':{'query':_0x1bc53a,'marketplace_ids':'5','sort':_0x348433[_0x5e8438(0x1b3)],'size':0x1f4,'from':0x0},'cv3Query':{'mp':0x5,'attributes':[_0x348433[_0x5e8438(0x1b1)],_0x348433[_0x5e8438(0x191)],_0x348433[_0x5e8438(0x18f)],_0x348433[_0x5e8438(0x168)],_0x348433[_0x5e8438(0x1a5)],_0x348433[_0x5e8438(0x17e)],_0x348433[_0x5e8438(0x1bd)],_0x348433[_0x5e8438(0x1bc)],_0x348433[_0x5e8438(0x1a8)],_0x348433[_0x5e8438(0x1ad)],_0x348433[_0x5e8438(0x142)]]},'requestOptions':[],'systemData':{'incomingRequestOs':_0x348433[_0x5e8438(0x12c)],'incomingRequestBrowserPlatform':_0x348433[_0x5e8438(0x13f)]}};_0x348433[_0x5e8438(0x160)](GM_xmlhttpRequest,{'method':_0x348433[_0x5e8438(0x136)],'url':_0x348433[_0x5e8438(0x1a3)],'data':JSON[_0x5e8438(0x19f)](_0x3f4e81),'headers':{'Content-Type':_0x348433[_0x5e8438(0x147)],'Authorization':_0x1e4f14},'onload':function(_0x240b84){const _0x5e8585=_0x5e8438;_0x3ce37e=JSON[_0x5e8585(0x1a4)](_0x240b84[_0x5e8585(0x174)+'xt']),_0x36a1ef[_0x5e8585(0x19b)](_0x379081,{'results':_0x4233c4,'crispData':_0x3ce37e});}});}});})[_0x17b6cb(0x1a9)](_0x14aa43=>{const _0x14d7ac=_0x17b6cb;console[_0x14d7ac(0x148)](_0x348433[_0x14d7ac(0x1cc)],_0x14aa43),_0x348433[_0x14d7ac(0x1b5)](_0x2c2342,_0x14aa43);});});}